# 非均匀B样条与NURBS的关系

## 非均匀B样条
**非均匀B样条**（Non-Uniform B-Spline）的特征是结向量（knot vector）不均匀分布。这种设计允许：
- 曲线在特定区域更密集（局部控制能力增强）
- 曲线在其他区域更平滑（减少冗余控制点）

---

## NURBS（非均匀有理B样条）
NURBS（**Non-Uniform Rational B-Spline**）在非均匀B样条的基础上引入了**权重**（`weights`），使其能够精确表示圆、椭圆、圆锥曲线等复杂形状。其核心公式为：

$$
P(u) = \frac{ \sum_{i=0}^{n} N_{i,k}(u) \cdot w_i \cdot P_i }{ \sum_{i=0}^{n} N_{i,k}(u) \cdot w_i }
$$

其中：
- $N_{i,k}(u)$：B样条基函数（与结向量相关）
- $w_i$：第 $i$ 个控制点的权重
- $P_i$：第 $i$ 个控制点的坐标（如 $(x, y, z)$）

### B样条基函数与Cox-de Boor递归公式

### B样条基函数定义
B样条基函数 $N_{i,k}(u)$ 通过递归方式定义，从零阶（$k=0$）开始逐步计算到指定阶数 $k$（degree）。

---

### Cox-de Boor 递归公式

### 零阶基函数（k = 0）
$$
N_{i,0}(u) = 
\begin{cases} 
1 & \text{if } t_i \leq u < t_{i+1} \\
0 & \text{otherwise}
\end{cases}
$$
- **$t_i$**：结向量（knot vector）中的第 $i$ 个结
- 表现为矩形函数，仅在对应区间 $[t_i, t_{i+1})$ 内取值为1

---

### 高阶基函数（k > 0）
$$
N_{i,k}(u) = \frac{u - t_i}{t_{i+k} - t_i}N_{i,k-1}(u) + \frac{t_{i+k+1} - u}{t_{i+k+1} - t_{i+1}}N_{i+1,k-1}(u)
$$

#### 公式解析
| 项                            | 说明                                                                 |
|-------------------------------|----------------------------------------------------------------------|
| **第一项** $\frac{u - t_i}{t_{i+k} - t_i}N_{i,k-1}(u)$ | 当前区间 $[t_i, t_{i+k})$ 的线性插值贡献                             |
| **第二项** $\frac{t_{i+k+1} - u}{t_{i+k+1} - t_{i+1}}N_{i+1,k-1}(u)$ | 下一区间 $[t_{i+1}, t_{i+k+1})$ 的线性插值贡献                       |

#### 特殊情况处理
若分母为零（即 $t_{i+k} = t_i$ 或 $t_{i+k+1} = t_{i+1}$），对应项直接视为 **0**。

---

## 权重 $w_i$ 的影响
权重值对曲线形状的控制具有显著作用：

| 权重特性          | 曲线行为                                                                 |
|-------------------|--------------------------------------------------------------------------|
| $w_i$ **显著增大** | 控制点 $P_i$ 对曲线的"拉力"增强，曲线更靠近该点                          |
| $w_i$ **趋近于0** | 控制点 $P_i$ 对曲线的影响几乎消失                                        |
| $w_i = 1$         | 退化为非均匀B样条（无权重影响）                                          |

---

### 应用示例（CAD建模）
假设两个控制点 $P_1$ 和 $P_2$，权重分别为 $w_1 = 10$ 和 $w_2 = 1$：
```cpp
// 伪代码示例：权重对曲线的影响
Point P1 = (0, 0);  // 权重 w1 = 10
Point P2 = (5, 5);  // 权重 w2 = 1

// 生成的NURBS曲线会明显靠近P1
NURBS_Curve curve({P1, P2}, {10, 1});
